# systemd drop-in configuration for debugging llama-server
# 
# Usage:
#   mkdir -p /etc/systemd/system/llama-server.service.d
#   cp this-file /etc/systemd/system/llama-server.service.d/debug.conf
#   systemctl daemon-reload
#   systemctl restart llama-server
#
# This configuration:
# - Enables core dumps (LimitCORE=infinity)
# - Sets up library path for bundled ROCm/HSA libraries
# - Increases logging verbosity
# - Disables some security hardening for easier debugging

[Service]
# Enable unlimited core dumps for post-mortem debugging
LimitCORE=infinity

# If using bundled ROCm/HSA libraries from /opt/llama/lib
# Environment="LD_LIBRARY_PATH=/opt/llama/lib:${LD_LIBRARY_PATH:-.}"

# If debugging, consider relaxing these (production should NOT have these)
# ProtectSystem=off          # Allow read-write access to /
# PrivateTmp=no             # Shared /tmp with system
# NoNewPrivileges=false     # Allow privilege escalation (not recommended)

# Enable debug logging to systemd journal
StandardOutput=journal
StandardError=journal
SyslogIdentifier=llama-server

# Optional: increase log level for more verbosity
# Environment="LLAMA_LOG_LEVEL=debug"
